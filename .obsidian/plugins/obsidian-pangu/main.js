'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

var formatUtil = {
    condenseContent(content) {
        // 将 制表符 改成 四个空格
        content = content.replace(/\t/g, "    ");
        // 删除超过2个的回车
        // Unix 的只有 LF，Windows 的需要 CR LF
        content = content.replace(/(\n){3,}/g, "$1$1");
        content = content.replace(/(\r\n){3,}/g, "$1$1");
        return content;
    },
    getIgnoreBlocks(lines, token = "```") {
        const ignoreBlocks = [];
        let block = null;
        lines.forEach((line, index) => {
            line = line.trim();
            if (line.startsWith(token)) {
                if (!block) {
                    block = { start: index, end: null };
                }
                else {
                    if (line === token) {
                        block.end = index;
                        ignoreBlocks.push(block);
                        block = null;
                    }
                }
            }
        });
        return ignoreBlocks;
    },
    deleteSpaces(content) {
        // 去掉「`()[]{}<>'"`」: 前后多余的空格
        content = content.replace(/\s+([\(\)\[\]\{\}<>'":])\s+/g, " $1 ");
        // 去掉连续括号增加的空格，例如：「` ( [ { <  > } ] ) `」
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, "$1$2 ");
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, "$1$2 ");
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, "$1$2 ");
        content = content.replace(/([<\(\{\[])\s([<\(\{\[])\s/g, "$1$2 ");
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, " $1$2");
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, " $1$2");
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, " $1$2");
        content = content.replace(/\s([>\)\]\}])\s([>\)\]\}])/g, " $1$2");
        // 去掉 「`$ () $`」, 「`$ [] $`」, 「`$ {} $`」 里面增加的空格
        // 去掉开始 $ 后面增加的空格，结束 $ 前面增加的空格
        // 去掉包裹代码的符号里面增加的空格
        // 去掉开始 ` 后面增加的空格，结束 ` 前面增加的空格
        content = content.replace(/([`\$])\s*([<\(\[\{])([^\$]*)\s*([`\$])/g, "$1$2$3$4");
        content = content.replace(/([`\$])\s*([^\$]*)([>\)\]\}])\s*([`\$])/g, "$1$2$3$4");
        // 去掉「`) _`」、「`) ^`」增加的空格
        content = content.replace(/\)\s([_\^])/g, ")$1");
        // 去掉 [^footnote,2002] 中的空格
        content = content.replace(/\[\s*\^([^\]\s]*)\s*\]/g, "[^$1]");
        // 将链接的格式中文括号“[]（）”改成英文括号“[]()”，去掉增加的空格
        content = content.replace(/\s*\[\s*([^\]]+)\s*\]\s*[（(]\s*([^\s\)]*)\s*[)）]\s*/g, " [$1]($2) ");
        // 将图片链接的格式中的多余空格“! []()”去掉，变成“![]()”
        content = content.replace(/!\s*\[\s*([^\]]+)\s*\]\s*[（(]\s*([^\s\)]*)\s*[)）]\s*/g, "![$1]($2) ");
        // 将网络地址中“ : // ”符号改成“://”
        content = content.replace(/\s*:\s*\/\s*\/\s*/g, "://");
        // 去掉行末空格
        content = content.replace(/(\S*)\s*$/g, "$1");
        // 去掉「123 °」和 「15 %」中的空格
        content = content.replace(/([0-9])\s*([°%])/g, "$1$2");
        // 去掉 2020 - 04 - 20, 08 : 00 : 00 这种日期时间表示的数字内的空格
        content = content.replace(/([0-9])\s*-\s*([0-9])/g, "$1-$2");
        content = content.replace(/([0-9])\s*:\s*([0-9])/g, "$1:$2");
        // 去掉 1 , 234 , 567 这种千分位表示的数字内的空格
        content = content.replace(/([0-9])\s*,\s*([0-9])/g, "$1,$2");
        // 全角標點與其他字符之間不加空格
        // 将无序列表的-后面的空格保留
        // 将有序列表的-后面的空格保留
        content = content.replace(/^(?<![-|\d.]\s*)\s*([，。、《》？『』「」；∶【】｛｝—！＠￥％…（）])\s*/g, "$1");
        return content;
    },
    insertSpace(content) {
        // 在 “中文English” 之间加入空格 “中文 English”
        // 在 “中文123” 之间加入空格 “中文 123”
        content = content.replace(/(?<!\[.*\]\(.*)([\u4e00-\u9fa5\u3040-\u30FF])([a-zA-Z0-9`])/g, "$1 $2");
        // 在 “English中文” 之间加入空格 “English 中文”
        // 在 “123中文” 之间加入空格 “123 中文”
        content = content.replace(/(?<!\[.*\]\(.*)([a-zA-Z0-9%`])([*]*[\u4e00-\u9fa5\u3040-\u30FF])/g, "$1 $2");
        // 在 「I said:it's a good news」的冒号与英文之间加入空格 「I said: it's a good news」
        content = content.replace(/([:])\s*([a-zA-z])/g, "$1 $2");
        return content;
    },
    replacePunctuations(content) {
        // `, \ . : ; ? !` 改成 `，、。：；？！`
        // 必须在结尾或者有空格的点才被改成句号
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])\.($|\s*)/g, "$1。");
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF]),/g, "$1，");
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF]);/g, "$1；");
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])!/g, "$1！");
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])\?/g, "$1？");
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])\\/g, "$1、");
        content = content.replace(/([\u4e00-\u9fa5\u3040-\u30FF])＼s*\:/g, "$1：");
        // 簡體中文使用直角引號
        content = content.replace(/‘/g, "『");
        content = content.replace(/’/g, "』");
        content = content.replace(/“/g, "「");
        content = content.replace(/”/g, "」");
        // 括号使用半角标点
        // 半角括号的两边都有空格就不在这里处理了，放到行中处理
        content = content.replace(/\s*[（(]\s*/g, " ( ");
        content = content.replace(/\s*[）)]\s*/g, " ) ");
        // 英文和数字内部的全角标点 `，。；‘’“”：？！＠＃％＆－＝＋｛｝【】｜＼～`改成半角标点
        content = content.replace(/(\w)\s*，\s*(\w)/g, "$1, $2");
        content = content.replace(/(\w)\s*。\s*(\w)/g, "$1. $2");
        content = content.replace(/(\w)\s*；\s*(\w)/g, "$1; $2");
        content = content.replace(/(\w)\s*‘\s*(\w)/g, "$1 '$2");
        content = content.replace(/(\w)\s*’\s*(\w)/g, "$1' $2");
        content = content.replace(/(\w)\s*“\s*(\w)/g, '$1 "$2');
        content = content.replace(/(\w)\s*”\s*(\w)/g, '$1" $2');
        content = content.replace(/(\w)\s*：\s*(\w)/g, "$1: $2");
        content = content.replace(/(\w)\s*？\s*(\w)/g, "$1? $2");
        content = content.replace(/(\w)\s*！\s*(\w)/g, "$1! $2");
        content = content.replace(/(\w)\s*＠\s*(\w)/g, "$1@$2");
        content = content.replace(/(\w)\s*＃\s*(\w)/g, "$1#$2");
        content = content.replace(/(\w)\s*％\s*(\w)/g, "$1 % $2");
        content = content.replace(/(\w)\s*＆\s*(\w)/g, "$1 & $2");
        content = content.replace(/(\w)\s*－\s*(\w)/g, "$1 - $2");
        content = content.replace(/(\w)\s*＝\s*(\w)/g, "$1 = $2");
        content = content.replace(/(\w)\s*＋\s*(\w)/g, "$1 + $2");
        content = content.replace(/(\w)\s*｛\s*(\w)/g, "$1 {$2");
        content = content.replace(/(\w)\s*｝\s*(\w)/g, "$1} $2");
        content = content.replace(/(\w)\s*[【\[]\s*(\w)/g, "$1 [$2");
        content = content.replace(/(\w)\s*[】\]]\s*(\w)/g, "$1] $2");
        content = content.replace(/(\w)\s*｜\s*(\w)/g, "$1 | $2");
        content = content.replace(/(\w)\s*＼\s*(\w)/g, "$1  $2");
        content = content.replace(/(\w)\s*～\s*(\w)/g, "$1~$2");
        // 连续三个以上的 `。` 改成 `......`
        content = content.replace(/[。]{3,}/g, "……");
        // 截断连续超过一个的 ？和！ 为一个，「！？」也算一个
        content = content.replace(/([！？]+)\1{1,}/g, "$1");
        // 截断连续超过一个的 。，；：、“”『』〖〗《》 为一个
        content = content.replace(/([。，；：、“”『』〖〗《》【】])\1{1,}/g, "$1");
        return content;
    },
    replaceFullNumbersAndChars(content) {
        // 替换全角数字 & 全角英文
        // Ａ -> A
        // ０ -> 0
        return content.replace(/[\uFF10-\uFF19\uFF21-\uFF5A]/g, c => String.fromCharCode(c.charCodeAt(0) - 0xfee0));
    },
    formatContent(content) {
        // 替换所有的全角数字和字母为半角
        content = this.replaceFullNumbersAndChars(content);
        // 删除多余的内容（回车）
        content = this.condenseContent(content);
        // 每行操作
        const lines = content.split("\n");
        const ignoreBlocks = this.getIgnoreBlocks(lines);
        content = lines
            .map((line, index) => {
            // 忽略代码块
            if (ignoreBlocks.some(({ start, end }) => {
                return index >= start && index <= end;
            })) {
                return line;
            }
            // 删除多余的空格
            line = this.deleteSpaces(line);
            // 插入必要的空格
            line = this.insertSpace(line);
            // 将有编号列表的“1. ”改成 “1.  ”
            line = line.replace(/^(\s*)(\d\.)\s+(\S)/, "$1$2  $3");
            // 将无编号列表的“* ”改成 “- ”
            // 将无编号列表的“- ”改成 “- ”
            line = line.replace(/^(\s*)[-\*]\s+(\S)/, "$1- $2");
            return line;
        })
            .join("\n");
        // 结束文档整理前再删除最后一个回车
        content = content.replace(/(\n){2,}$/g, "$1");
        content = content.replace(/(\r\n){2,}$/g, "$1");
        return content;
    },
};

class Pangu extends obsidian.Plugin {
    format(cm) {
        let cursor = cm.getCursor();
        let cursorContent = cm.getRange(Object.assign(Object.assign({}, cursor), { ch: 0 }), cursor);
        const { top } = cm.getScrollInfo();
        cursorContent = formatUtil.formatContent(cursorContent);
        let content = cm.getValue().trim();
        content = content + '\n\n';
        content = formatUtil.formatContent(content);
        cm.setValue(content);
        cm.scrollTo(null, top);
        // 保持光标格式化后不变
        const newDocLine = cm.getLine(cursor.line);
        try {
            cursor = Object.assign(Object.assign({}, cursor), { ch: newDocLine.indexOf(cursorContent) + cursorContent.length });
        }
        catch (error) { }
        cm.setCursor(cursor);
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            this.addCommand({
                id: 'pangu-format',
                name: '为中英文字符间自动加入空格',
                callback: () => {
                    const activeLeafView = this.app.workspace.getActiveViewOfType(obsidian.MarkdownView);
                    if (activeLeafView) {
                        this.format(activeLeafView.sourceMode.cmEditor);
                    }
                },
                hotkeys: [
                    {
                        modifiers: ['Mod', 'Shift'],
                        key: 's',
                    },
                    {
                        modifiers: ['Ctrl', 'Shift'],
                        key: 's',
                    },
                ],
            });
            this.addSettingTab(new PanguSettingTab(this.app, this));
        });
    }
    onunload() {
        console.log('unloading plugin');
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () { });
    }
}
class PanguSettingTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Pangu 使用说明' });
        new obsidian.Setting(containerEl).setName('').setDesc('默认快捷键为:Mac - Command + Shift + S，Windows -  Shift + Ctrl + S。当然，您可以到「设置 - 快捷键」里进行更改。');
    }
}

module.exports = Pangu;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsImZvcm1hdFV0aWwudHMiLCJtYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkgX19jcmVhdGVCaW5kaW5nKG8sIG0sIHApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tLCBwYWNrKSB7XHJcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcclxuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcclxuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG52YXIgX19zZXRNb2R1bGVEZWZhdWx0ID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XHJcbn0pIDogZnVuY3Rpb24obywgdikge1xyXG4gICAgb1tcImRlZmF1bHRcIl0gPSB2O1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoayAhPT0gXCJkZWZhdWx0XCIgJiYgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIF9fY3JlYXRlQmluZGluZyhyZXN1bHQsIG1vZCwgayk7XHJcbiAgICBfX3NldE1vZHVsZURlZmF1bHQocmVzdWx0LCBtb2QpO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgZ2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZFNldChyZWNlaXZlciwgc3RhdGUsIHZhbHVlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJtXCIpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIG1ldGhvZCBpcyBub3Qgd3JpdGFibGVcIik7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB3cml0ZSBwcml2YXRlIG1lbWJlciB0byBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIChraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlciwgdmFsdWUpIDogZiA/IGYudmFsdWUgPSB2YWx1ZSA6IHN0YXRlLnNldChyZWNlaXZlciwgdmFsdWUpKSwgdmFsdWU7XHJcbn1cclxuIiwiaW50ZXJmYWNlIElnbm9yZUJsb2NrIHtcbiAgc3RhcnQ6IG51bWJlciB8IG51bGw7XG4gIGVuZDogbnVtYmVyIHwgbnVsbDtcbn1cbmV4cG9ydCBkZWZhdWx0IHtcbiAgY29uZGVuc2VDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8g5bCGIOWItuihqOespiDmlLnmiJAg5Zub5Liq56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFx0L2csIFwiICAgIFwiKTtcblxuICAgIC8vIOWIoOmZpOi2hei/hzLkuKrnmoTlm57ovaZcbiAgICAvLyBVbml4IOeahOWPquaciSBMRu+8jFdpbmRvd3Mg55qE6ZyA6KaBIENSIExGXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcbil7Myx9L2csIFwiJDEkMVwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFxyXFxuKXszLH0vZywgXCIkMSQxXCIpO1xuICAgIHJldHVybiBjb250ZW50O1xuICB9LFxuICBnZXRJZ25vcmVCbG9ja3MobGluZXM6IHN0cmluZ1tdLCB0b2tlbjogc3RyaW5nID0gXCJgYGBcIik6IElnbm9yZUJsb2NrW10ge1xuICAgIGNvbnN0IGlnbm9yZUJsb2NrczogSWdub3JlQmxvY2tbXSA9IFtdO1xuICAgIGxldCBibG9jazogSWdub3JlQmxvY2sgfCBudWxsID0gbnVsbDtcbiAgICBsaW5lcy5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xuICAgICAgbGluZSA9IGxpbmUudHJpbSgpO1xuICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCh0b2tlbikpIHtcbiAgICAgICAgaWYgKCFibG9jaykge1xuICAgICAgICAgIGJsb2NrID0geyBzdGFydDogaW5kZXgsIGVuZDogbnVsbCB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChsaW5lID09PSB0b2tlbikge1xuICAgICAgICAgICAgYmxvY2suZW5kID0gaW5kZXg7XG4gICAgICAgICAgICBpZ25vcmVCbG9ja3MucHVzaChibG9jayk7XG4gICAgICAgICAgICBibG9jayA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGlnbm9yZUJsb2NrcztcbiAgfSxcbiAgZGVsZXRlU3BhY2VzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8g5Y675o6J44CMYCgpW117fTw+J1wiYOOAjTog5YmN5ZCO5aSa5L2Z55qE56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKyhbXFwoXFwpXFxbXFxdXFx7XFx9PD4nXCI6XSlcXHMrL2csIFwiICQxIFwiKTtcblxuICAgIC8vIOWOu+aOiei/nue7reaLrOWPt+WinuWKoOeahOepuuagvO+8jOS+i+Wmgu+8muOAjGAgKCBbIHsgPCAgPiB9IF0gKSBg44CNXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFs8XFwoXFx7XFxbXSlcXHMoWzxcXChcXHtcXFtdKVxccy9nLCBcIiQxJDIgXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbPFxcKFxce1xcW10pXFxzKFs8XFwoXFx7XFxbXSlcXHMvZywgXCIkMSQyIFwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzxcXChcXHtcXFtdKVxccyhbPFxcKFxce1xcW10pXFxzL2csIFwiJDEkMiBcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFs8XFwoXFx7XFxbXSlcXHMoWzxcXChcXHtcXFtdKVxccy9nLCBcIiQxJDIgXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xccyhbPlxcKVxcXVxcfV0pXFxzKFs+XFwpXFxdXFx9XSkvZywgXCIgJDEkMlwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHMoWz5cXClcXF1cXH1dKVxccyhbPlxcKVxcXVxcfV0pL2csIFwiICQxJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKFs+XFwpXFxdXFx9XSlcXHMoWz5cXClcXF1cXH1dKS9nLCBcIiAkMSQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xccyhbPlxcKVxcXVxcfV0pXFxzKFs+XFwpXFxdXFx9XSkvZywgXCIgJDEkMlwiKTtcblxuICAgIC8vIOWOu+aOiSDjgIxgJCAoKSAkYOOAjSwg44CMYCQgW10gJGDjgI0sIOOAjGAkIHt9ICRg44CNIOmHjOmdouWinuWKoOeahOepuuagvFxuICAgIC8vIOWOu+aOieW8gOWniyAkIOWQjumdouWinuWKoOeahOepuuagvO+8jOe7k+adnyAkIOWJjemdouWinuWKoOeahOepuuagvFxuICAgIC8vIOWOu+aOieWMheijueS7o+eggeeahOespuWPt+mHjOmdouWinuWKoOeahOepuuagvFxuICAgIC8vIOWOu+aOieW8gOWniyBgIOWQjumdouWinuWKoOeahOepuuagvO+8jOe7k+adnyBgIOWJjemdouWinuWKoOeahOepuuagvFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoXG4gICAgICAvKFtgXFwkXSlcXHMqKFs8XFwoXFxbXFx7XSkoW15cXCRdKilcXHMqKFtgXFwkXSkvZyxcbiAgICAgIFwiJDEkMiQzJDRcIlxuICAgICk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcbiAgICAgIC8oW2BcXCRdKVxccyooW15cXCRdKikoWz5cXClcXF1cXH1dKVxccyooW2BcXCRdKS9nLFxuICAgICAgXCIkMSQyJDMkNFwiXG4gICAgKTtcblxuICAgIC8vIOWOu+aOieOAjGApIF9g44CN44CB44CMYCkgXmDjgI3lop7liqDnmoTnqbrmoLxcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXClcXHMoW19cXF5dKS9nLCBcIikkMVwiKTtcblxuICAgIC8vIOWOu+aOiSBbXmZvb3Rub3RlLDIwMDJdIOS4reeahOepuuagvFxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcW1xccypcXF4oW15cXF1cXHNdKilcXHMqXFxdL2csIFwiW14kMV1cIik7XG5cbiAgICAvLyDlsIbpk77mjqXnmoTmoLzlvI/kuK3mlofmi6zlj7figJxbXe+8iO+8ieKAneaUueaIkOiLseaWh+aLrOWPt+KAnFtdKCnigJ3vvIzljrvmjonlop7liqDnmoTnqbrmoLxcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKFxuICAgICAgL1xccypcXFtcXHMqKFteXFxdXSspXFxzKlxcXVxccypb77yIKF1cXHMqKFteXFxzXFwpXSopXFxzKlsp77yJXVxccyovZyxcbiAgICAgIFwiIFskMV0oJDIpIFwiXG4gICAgKTtcblxuICAgIC8vIOWwhuWbvueJh+mTvuaOpeeahOagvOW8j+S4reeahOWkmuS9meepuuagvOKAnCEgW10oKeKAneWOu+aOie+8jOWPmOaIkOKAnCFbXSgp4oCdXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcbiAgICAgIC8hXFxzKlxcW1xccyooW15cXF1dKylcXHMqXFxdXFxzKlvvvIgoXVxccyooW15cXHNcXCldKilcXHMqWynvvIldXFxzKi9nLFxuICAgICAgXCIhWyQxXSgkMikgXCJcbiAgICApO1xuXG4gICAgLy8g5bCG572R57uc5Zyw5Z2A5Lit4oCcIDogLy8g4oCd56ym5Y+35pS55oiQ4oCcOi8v4oCdXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKjpcXHMqXFwvXFxzKlxcL1xccyovZywgXCI6Ly9cIik7XG5cbiAgICAvLyDljrvmjonooYzmnKvnqbrmoLxcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFxTKilcXHMqJC9nLCBcIiQxXCIpO1xuXG4gICAgLy8g5Y675o6J44CMMTIzIMKw44CN5ZKMIOOAjDE1ICXjgI3kuK3nmoTnqbrmoLxcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzAtOV0pXFxzKihbwrAlXSkvZywgXCIkMSQyXCIpO1xuXG4gICAgLy8g5Y675o6JIDIwMjAgLSAwNCAtIDIwLCAwOCA6IDAwIDogMDAg6L+Z56eN5pel5pyf5pe26Ze06KGo56S655qE5pWw5a2X5YaF55qE56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFswLTldKVxccyotXFxzKihbMC05XSkvZywgXCIkMS0kMlwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzAtOV0pXFxzKjpcXHMqKFswLTldKS9nLCBcIiQxOiQyXCIpO1xuXG4gICAgLy8g5Y675o6JIDEgLCAyMzQgLCA1Njcg6L+Z56eN5Y2D5YiG5L2N6KGo56S655qE5pWw5a2X5YaF55qE56m65qC8XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFswLTldKVxccyosXFxzKihbMC05XSkvZywgXCIkMSwkMlwiKTtcblxuICAgIC8vIOWFqOinkuaomem7nuiIh+WFtuS7luWtl+espuS5i+mWk+S4jeWKoOepuuagvFxuICAgIC8vIOWwhuaXoOW6j+WIl+ihqOeahC3lkI7pnaLnmoTnqbrmoLzkv53nlZlcbiAgICAvLyDlsIbmnInluo/liJfooajnmoQt5ZCO6Z2i55qE56m65qC85L+d55WZXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcbiAgICAgIC9eKD88IVstfFxcZC5dXFxzKilcXHMqKFvvvIzjgILjgIHjgIrjgIvvvJ/jgI7jgI/jgIzjgI3vvJviiLbjgJDjgJHvvZvvvZ3igJTvvIHvvKDvv6XvvIXigKbvvIjvvIldKVxccyovZyxcbiAgICAgIFwiJDFcIlxuICAgICk7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH0sXG5cbiAgaW5zZXJ0U3BhY2UoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyDlnKgg4oCc5Lit5paHRW5nbGlzaOKAnSDkuYvpl7TliqDlhaXnqbrmoLwg4oCc5Lit5paHIEVuZ2xpc2jigJ1cbiAgICAvLyDlnKgg4oCc5Lit5paHMTIz4oCdIOS5i+mXtOWKoOWFpeepuuagvCDigJzkuK3mlocgMTIz4oCdXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcbiAgICAgIC8oPzwhXFxbLipcXF1cXCguKikoW1xcdTRlMDAtXFx1OWZhNVxcdTMwNDAtXFx1MzBGRl0pKFthLXpBLVowLTlgXSkvZyxcbiAgICAgIFwiJDEgJDJcIlxuICAgICk7XG5cbiAgICAvLyDlnKgg4oCcRW5nbGlzaOS4reaWh+KAnSDkuYvpl7TliqDlhaXnqbrmoLwg4oCcRW5nbGlzaCDkuK3mlofigJ1cbiAgICAvLyDlnKgg4oCcMTIz5Lit5paH4oCdIOS5i+mXtOWKoOWFpeepuuagvCDigJwxMjMg5Lit5paH4oCdXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcbiAgICAgIC8oPzwhXFxbLipcXF1cXCguKikoW2EtekEtWjAtOSVgXSkoWypdKltcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKS9nLFxuICAgICAgXCIkMSAkMlwiXG4gICAgKTtcblxuICAgIC8vIOWcqCDjgIxJIHNhaWQ6aXQncyBhIGdvb2QgbmV3c+OAjeeahOWGkuWPt+S4juiLseaWh+S5i+mXtOWKoOWFpeepuuagvCDjgIxJIHNhaWQ6IGl0J3MgYSBnb29kIG5ld3PjgI1cbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oWzpdKVxccyooW2EtekEtel0pL2csIFwiJDEgJDJcIik7XG5cbiAgICByZXR1cm4gY29udGVudDtcbiAgfSxcbiAgcmVwbGFjZVB1bmN0dWF0aW9ucyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIGAsIFxcIC4gOiA7ID8gIWAg5pS55oiQIGDvvIzjgIHjgILvvJrvvJvvvJ/vvIFgXG4gICAgLy8g5b+F6aG75Zyo57uT5bC+5oiW6ICF5pyJ56m65qC855qE54K55omN6KKr5pS55oiQ5Y+l5Y+3XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShcbiAgICAgIC8oW1xcdTRlMDAtXFx1OWZhNVxcdTMwNDAtXFx1MzBGRl0pXFwuKCR8XFxzKikvZyxcbiAgICAgIFwiJDHjgIJcIlxuICAgICk7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKSwvZywgXCIkMe+8jFwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW1xcdTRlMDAtXFx1OWZhNVxcdTMwNDAtXFx1MzBGRl0pOy9nLCBcIiQx77ybXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbXFx1NGUwMC1cXHU5ZmE1XFx1MzA0MC1cXHUzMEZGXSkhL2csIFwiJDHvvIFcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKVxcPy9nLCBcIiQx77yfXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbXFx1NGUwMC1cXHU5ZmE1XFx1MzA0MC1cXHUzMEZGXSlcXFxcL2csIFwiJDHjgIFcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFtcXHU0ZTAwLVxcdTlmYTVcXHUzMDQwLVxcdTMwRkZdKe+8vHMqXFw6L2csIFwiJDHvvJpcIik7XG5cbiAgICAvLyDnsKHpq5TkuK3mlofkvb/nlKjnm7Top5LlvJXomZ9cbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC/igJgvZywgXCLjgI5cIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgv4oCZL2csIFwi44CPXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL+KAnC9nLCBcIuOAjFwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC/igJ0vZywgXCLjgI1cIik7XG4gICAgLy8g5ous5Y+35L2/55So5Y2K6KeS5qCH54K5XG4gICAgLy8g5Y2K6KeS5ous5Y+355qE5Lik6L656YO95pyJ56m65qC85bCx5LiN5Zyo6L+Z6YeM5aSE55CG5LqG77yM5pS+5Yiw6KGM5Lit5aSE55CGXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKlvvvIgoXVxccyovZywgXCIgKCBcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzKlvvvIkpXVxccyovZywgXCIgKSBcIik7XG5cbiAgICAvLyDoi7HmloflkozmlbDlrZflhoXpg6jnmoTlhajop5LmoIfngrkgYO+8jOOAgu+8m+KAmOKAmeKAnOKAne+8mu+8n++8ge+8oO+8g++8he+8hu+8je+8ne+8i++9m++9neOAkOOAke+9nO+8vO+9nmDmlLnmiJDljYrop5LmoIfngrlcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvIxcXHMqKFxcdykvZywgXCIkMSwgJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq44CCXFxzKihcXHcpL2csIFwiJDEuICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8m1xccyooXFx3KS9nLCBcIiQxOyAkMlwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrigJhcXHMqKFxcdykvZywgXCIkMSAnJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq4oCZXFxzKihcXHcpL2csIFwiJDEnICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKuKAnFxccyooXFx3KS9nLCAnJDEgXCIkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKuKAnVxccyooXFx3KS9nLCAnJDFcIiAkMicpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8mlxccyooXFx3KS9nLCBcIiQxOiAkMlwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvJ9cXHMqKFxcdykvZywgXCIkMT8gJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yBXFxzKihcXHcpL2csIFwiJDEhICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8oFxccyooXFx3KS9nLCBcIiQxQCQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8g1xccyooXFx3KS9nLCBcIiQxIyQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8hVxccyooXFx3KS9nLCBcIiQxICUgJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yGXFxzKihcXHcpL2csIFwiJDEgJiAkMlwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvI1cXHMqKFxcdykvZywgXCIkMSAtICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+8nVxccyooXFx3KS9nLCBcIiQxID0gJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77yLXFxzKihcXHcpL2csIFwiJDEgKyAkMlwiKTtcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oXFx3KVxccyrvvZtcXHMqKFxcdykvZywgXCIkMSB7JDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq772dXFxzKihcXHcpL2csIFwiJDF9ICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKlvjgJBcXFtdXFxzKihcXHcpL2csIFwiJDEgWyQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKlvjgJFcXF1dXFxzKihcXHcpL2csIFwiJDFdICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+9nFxccyooXFx3KS9nLCBcIiQxIHwgJDJcIik7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcdylcXHMq77y8XFxzKihcXHcpL2csIFwiJDEgICQyXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHcpXFxzKu+9nlxccyooXFx3KS9nLCBcIiQxfiQyXCIpO1xuICAgIC8vIOi/nue7reS4ieS4quS7peS4iueahCBg44CCYCDmlLnmiJAgYC4uLi4uLmBcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9b44CCXXszLH0vZywgXCLigKbigKZcIik7XG4gICAgLy8g5oiq5pat6L+e57ut6LaF6L+H5LiA5Liq55qEIO+8n+WSjO+8gSDkuLrkuIDkuKrvvIzjgIzvvIHvvJ/jgI3kuZ/nrpfkuIDkuKpcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW++8ge+8n10rKVxcMXsxLH0vZywgXCIkMVwiKTtcbiAgICAvLyDmiKrmlq3ov57nu63otoXov4fkuIDkuKrnmoQg44CC77yM77yb77ya44CB4oCc4oCd44CO44CP44CW44CX44CK44CLIOS4uuS4gOS4qlxuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhb44CC77yM77yb77ya44CB4oCc4oCd44CO44CP44CW44CX44CK44CL44CQ44CRXSlcXDF7MSx9L2csIFwiJDFcIik7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH0sXG5cbiAgcmVwbGFjZUZ1bGxOdW1iZXJzQW5kQ2hhcnMoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyDmm7/mjaLlhajop5LmlbDlrZcgJiDlhajop5Loi7HmlodcbiAgICAvLyDvvKEgLT4gQVxuICAgIC8vIO+8kCAtPiAwXG4gICAgcmV0dXJuIGNvbnRlbnQucmVwbGFjZSgvW1xcdUZGMTAtXFx1RkYxOVxcdUZGMjEtXFx1RkY1QV0vZywgYyA9PlxuICAgICAgU3RyaW5nLmZyb21DaGFyQ29kZShjLmNoYXJDb2RlQXQoMCkgLSAweGZlZTApXG4gICAgKTtcbiAgfSxcblxuICBmb3JtYXRDb250ZW50KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8g5pu/5o2i5omA5pyJ55qE5YWo6KeS5pWw5a2X5ZKM5a2X5q+N5Li65Y2K6KeSXG4gICAgY29udGVudCA9IHRoaXMucmVwbGFjZUZ1bGxOdW1iZXJzQW5kQ2hhcnMoY29udGVudCk7XG5cbiAgICAvLyDliKDpmaTlpJrkvZnnmoTlhoXlrrnvvIjlm57ovabvvIlcbiAgICBjb250ZW50ID0gdGhpcy5jb25kZW5zZUNvbnRlbnQoY29udGVudCk7XG5cbiAgICAvLyDmr4/ooYzmk43kvZxcbiAgICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoXCJcXG5cIik7XG5cbiAgICBjb25zdCBpZ25vcmVCbG9ja3M6IElnbm9yZUJsb2NrW10gPSB0aGlzLmdldElnbm9yZUJsb2NrcyhsaW5lcyk7XG5cbiAgICBjb250ZW50ID0gbGluZXNcbiAgICAgIC5tYXAoKGxpbmU6IHN0cmluZywgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAvLyDlv73nlaXku6PnoIHlnZdcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGlnbm9yZUJsb2Nrcy5zb21lKCh7IHN0YXJ0LCBlbmQgfSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4ID49IHN0YXJ0ICYmIGluZGV4IDw9IGVuZDtcbiAgICAgICAgICB9KVxuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gbGluZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOWIoOmZpOWkmuS9meeahOepuuagvFxuICAgICAgICBsaW5lID0gdGhpcy5kZWxldGVTcGFjZXMobGluZSk7XG5cbiAgICAgICAgLy8g5o+S5YWl5b+F6KaB55qE56m65qC8XG4gICAgICAgIGxpbmUgPSB0aGlzLmluc2VydFNwYWNlKGxpbmUpO1xuXG4gICAgICAgIC8vIOWwhuaciee8luWPt+WIl+ihqOeahOKAnDEuIOKAneaUueaIkCDigJwxLiAg4oCdXG4gICAgICAgIGxpbmUgPSBsaW5lLnJlcGxhY2UoL14oXFxzKikoXFxkXFwuKVxccysoXFxTKS8sIFwiJDEkMiAgJDNcIik7XG5cbiAgICAgICAgLy8g5bCG5peg57yW5Y+35YiX6KGo55qE4oCcKiDigJ3mlLnmiJAg4oCcLSDigJ1cbiAgICAgICAgLy8g5bCG5peg57yW5Y+35YiX6KGo55qE4oCcLSDigJ3mlLnmiJAg4oCcLSDigJ1cbiAgICAgICAgbGluZSA9IGxpbmUucmVwbGFjZSgvXihcXHMqKVstXFwqXVxccysoXFxTKS8sIFwiJDEtICQyXCIpO1xuXG4gICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgfSlcbiAgICAgIC5qb2luKFwiXFxuXCIpO1xuXG4gICAgLy8g57uT5p2f5paH5qGj5pW055CG5YmN5YaN5Yig6Zmk5pyA5ZCO5LiA5Liq5Zue6L2mXG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFxcbil7Mix9JC9nLCBcIiQxXCIpO1xuICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhcXHJcXG4pezIsfSQvZywgXCIkMVwiKTtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfSxcbn07XG4iLCJpbXBvcnQgeyBBcHAsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgZm9ybWF0VXRpbCBmcm9tICcuL2Zvcm1hdFV0aWwnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFuZ3UgZXh0ZW5kcyBQbHVnaW4ge1xyXG4gIGZvcm1hdChjbTogQ29kZU1pcnJvci5FZGl0b3IpOiB2b2lkIHtcclxuICAgIGxldCBjdXJzb3IgPSBjbS5nZXRDdXJzb3IoKTtcclxuICAgIGxldCBjdXJzb3JDb250ZW50ID0gY20uZ2V0UmFuZ2UoeyAuLi5jdXJzb3IsIGNoOiAwIH0sIGN1cnNvcik7XHJcbiAgICBjb25zdCB7IHRvcCB9ID0gY20uZ2V0U2Nyb2xsSW5mbygpO1xyXG5cclxuICAgIGN1cnNvckNvbnRlbnQgPSBmb3JtYXRVdGlsLmZvcm1hdENvbnRlbnQoY3Vyc29yQ29udGVudCk7XHJcblxyXG4gICAgbGV0IGNvbnRlbnQgPSBjbS5nZXRWYWx1ZSgpLnRyaW0oKTtcclxuICAgIGNvbnRlbnQgPSBjb250ZW50ICsgJ1xcblxcbic7XHJcbiAgICBjb250ZW50ID0gZm9ybWF0VXRpbC5mb3JtYXRDb250ZW50KGNvbnRlbnQpO1xyXG5cclxuICAgIGNtLnNldFZhbHVlKGNvbnRlbnQpO1xyXG5cclxuICAgIGNtLnNjcm9sbFRvKG51bGwsIHRvcCk7XHJcblxyXG4gICAgLy8g5L+d5oyB5YWJ5qCH5qC85byP5YyW5ZCO5LiN5Y+YXHJcbiAgICBjb25zdCBuZXdEb2NMaW5lID0gY20uZ2V0TGluZShjdXJzb3IubGluZSk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjdXJzb3IgPSB7IC4uLmN1cnNvciwgY2g6IG5ld0RvY0xpbmUuaW5kZXhPZihjdXJzb3JDb250ZW50KSArIGN1cnNvckNvbnRlbnQubGVuZ3RoIH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge31cclxuXHJcbiAgICBjbS5zZXRDdXJzb3IoY3Vyc29yKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgIGlkOiAncGFuZ3UtZm9ybWF0JyxcclxuICAgICAgbmFtZTogJ+S4uuS4reiLseaWh+Wtl+espumXtOiHquWKqOWKoOWFpeepuuagvCcsXHJcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlTGVhZlZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgIGlmIChhY3RpdmVMZWFmVmlldykge1xyXG4gICAgICAgICAgdGhpcy5mb3JtYXQoYWN0aXZlTGVhZlZpZXcuc291cmNlTW9kZS5jbUVkaXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBob3RrZXlzOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgbW9kaWZpZXJzOiBbJ01vZCcsICdTaGlmdCddLFxyXG4gICAgICAgICAga2V5OiAncycsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBtb2RpZmllcnM6IFsnQ3RybCcsICdTaGlmdCddLFxyXG4gICAgICAgICAga2V5OiAncycsXHJcbiAgICAgICAgfSxcclxuICAgICAgXSxcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgUGFuZ3VTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcbiAgfVxyXG5cclxuICBvbnVubG9hZCgpIHtcclxuICAgIGNvbnNvbGUubG9nKCd1bmxvYWRpbmcgcGx1Z2luJyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7fVxyXG59XHJcblxyXG5jbGFzcyBQYW5ndVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IFBhbmd1O1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQYW5ndSkge1xyXG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgbGV0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnUGFuZ3Ug5L2/55So6K+05piOJyB9KTtcclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCcnKS5zZXREZXNjKCfpu5jorqTlv6vmjbfplK7kuLo6TWFjIC0gQ29tbWFuZCArIFNoaWZ0ICsgU++8jFdpbmRvd3MgLSAgU2hpZnQgKyBDdHJsICsgU+OAguW9k+eEtu+8jOaCqOWPr+S7peWIsOOAjOiuvue9riAtIOW/q+aNt+mUruOAjemHjOi/m+ihjOabtOaUueOAgicpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiUGx1Z2luIiwiTWFya2Rvd25WaWV3IiwiUGx1Z2luU2V0dGluZ1RhYiIsIlNldHRpbmciXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdURBO0FBQ08sU0FBUyxTQUFTLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFO0FBQzdELElBQUksU0FBUyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsT0FBTyxLQUFLLFlBQVksQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxVQUFVLE9BQU8sRUFBRSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFO0FBQ2hILElBQUksT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUUsVUFBVSxPQUFPLEVBQUUsTUFBTSxFQUFFO0FBQy9ELFFBQVEsU0FBUyxTQUFTLENBQUMsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtBQUNuRyxRQUFRLFNBQVMsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtBQUN0RyxRQUFRLFNBQVMsSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsRUFBRTtBQUN0SCxRQUFRLElBQUksQ0FBQyxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxD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LE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDeEQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDdkQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDekQsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENB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
